##1.3. Качество данных
Оценим качество данных, на основе которых будут строится метрики.
В базе две схемы: production и analysis. Таблицы, необходимые для построения витрины находятся в схеме `production`.

### 1.3.1. Ограничения на данные в базе данных

| Таблица       | Поле     | Тип         |Ограничения            | Цель ограничения                                              |
| ------------- | ---------|-------------|-----------------------| ------------------------------------------------------------- |
| users         | id       | int4        | NOT NULL, PRIMARY KEY |Обеспечение уникальности и отсутствие пустых записей о пользователях |
| orderstatuses | id       | int4        | NOT NULL, PRIMARY KEY |Обеспечение уникальности и отсутствие пустых записей о статусах заказов |
| orderstatuses | key      | varchar(255)| NOT NULL              |Обеспечивает отсутствие пустых значений поля ключа статуса заказа|
| orders        | order_id | int4        | NOT NULL, PRIMARY KEY |Обеспечение уникальности и отсутствие пустых записей о заказах |
| orders        | users_id | int4        | NOT NULL              |Обеспечение отсутствие пустых записей о пользователях, совершивших заказы|
| orders        | status   | int4        | NOT NULL              |Обеспечение отсутствие пустых записей о статусе заказов|
| orders        | order_ts | timestamp   | NOT NULL              |Обеспечение отсутствие пустых записей о времени совершения заказов|

Имеющиеся ограничения обеспечивают коннктные типы данных, отсутствие пропущенных значений и дублей  ключевых полях.

### 1.3.2. Выполнение требований витрины
Таблица с заказами `orders` содержит данные о 10 000 заказах

SELECT COUNT(1), COUNT(DISTINCT users_id)  
FROM orders;

**Проверка периода данных в базе**

SELECT min(order_ts), max(order_ts)  
FROM orders

Данные содержатся за период с по 

SELECT DATE_TRUNC('month', order_ts)::date, count(1)  
FROM orders  
GROUP BY 1  
ORDER BY 1

| Месяц             | Кол-во заказов в месяц     | 
| ----------------- | ---------------------------|
| февраль 2022 года | 5705                       | 
| март 2022 года    | 4295                       | 

Данные содержатся только за 2 месяца, начиная с февраля 2022 года, а по заданию требуется период с начала 2022 года. 
Данных не хватает, но мы можем лишь спросить о наличии данных за январь у заказчика. Взять нам их неоткуда
